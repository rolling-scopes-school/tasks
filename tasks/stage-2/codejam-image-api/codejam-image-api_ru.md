| Срок исполнения  | Имя папки         | branch            |
| ---------------- | ----------------- | ----------------- |
| 18.11.2019 23:59 | codejam-image-api | codejam-image-api |

# Codejam image-api

## Задача

Ваша задача - реализовать загрузку изображения из сервиса https://source.unsplash.com/ на канвас из [codejam-canvas](https://github.com/rolling-scopes-school/tasks/blob/master/tasks/stage-2/codejam-canvas/codejam-canvas.md) / [codejam-palette](https://github.com/rolling-scopes-school/tasks/blob/master/tasks/stage-2/codejam-palette/codejam-palette_en.md)

### UX прототип

Используется layout предыдущего задания

Вот файл, который нужно открыть в редакторе figma - ./data/codejam-image-api.fig

Онлайн-версия - https://www.figma.com/proto/0vp10ujmM0Vy3dhxThCBC5/codejam-image-api?node-id=0%3A1&scaling=min-zoom

## Требования к функционалу приложения

- Инструмент карандаш должен работать и рисовать поверх изображения.
- При загрузке на канвас изображение должно размещаться в центе канваса сохранять свои пропорции и занимать всю площадь канваса
  - если изображение не квадратное, часть области канваса остаётся пустой
- для обычной сложности размер виртуального поля канваса - 128х128, размер самого канваса - 512px, размер виртуального пикселя - 4px (512px = 128\*4px)
- Есть возможность изменить размер поля канваса: 128x128 или 256x256, или 512 x 512.

Что нужно добавить к макету предыдущих заданий

- Кнопку загрузки случайного изображения для выбранного вами города
- Поле, в котором можно указать город, изображение которого будет загружаться на канвас

Для задания повышенной сложности

- Панель для переключения размера поля 128x128 или 256x256, или 512 x 512. Канвас при этом остается размером 512px (меняется размер виртуального пикселя - 4x4, 2x2 или 1x1 соответственно).
- Кнопку перевода изображения в черно-белый вид для задания повышенной сложности

### Кнопка загрузки изображения

Для выполнения задания необходимо загрузить на канвас изображение с сайта https://source.unsplash.com/
Должно быть использовано апи - https://unsplash.com/documentation#search-photos

**Как получить изображение с сайта unsplash.com**

Последовательность действий приведена как пример, ее можно изменять или использовать свою.

1. регистрируемся на сайте https://unsplash.com/developers кнопка **Register as a developer**
2. подтверждаем email (переходим по ссылке, которая пришла на почту)
3. создаём приложение https://unsplash.com/oauth/applications
4. получаем Access Key
5. получаем результат по ссылке

`https://api.unsplash.com/photos/random?query=town,Minsk&client_id=e2077ad31a806c894c460aec8f81bc2af4d09c4f8104ae3177bb809faf0eac17`

Здесь

- `town,Minsk` - ключевые слова для поиска
- `e2077ad31a806c894c460aec8f81bc2af4d09c4f8104ae3177bb809faf0eac17` - Access Key (у вас будет другой)

6. JS-код для получения ссылки на изображение (ссылка выводится в консоль)

```
function getLinkToImage() {
const url = 'https://api.unsplash.com/photos/random?query=town,Minsk&client_id=e2077ad31a806c894c460aec8f81bc2af4d09c4f8104ae3177bb809faf0eac17';
fetch(url)
  .then(res => res.json())
  .then(data => {
    console.log(data.urls.small)
  });
}
```

### Кнопку перевода изображения в черно-белый вид

Кнопка переводит изображение в черно-белый вид (grayscale). Если изображения еще нет - выводится алерт, что надо сначала загрузить изображение.

### Инструменты

Страница должна начинаться с выбранным инструментом "карандаш".

### Сессия пользователя

При обновлении страницы сохраняется предыдущее состояние приложения: выбранный цвет, инструмент, размер холста, загруженное изображение. Если поверх изображения были сделаны рисунки карандашом или заливкой, их нужно тоже сохранять. Эта функция должна быть реализована с помощью localStorage API. Дополнительных запросов на сервер при обновлении страницы быть не должно.

### Нефункциональные требования

#### eslint

`eslint` должен быть настроен

- `eslint` включен в` package.json`,
- вы должны использовать конфигурацию `eslint-config-airbnb-base`
- весь код должен быть проверен
- проверка eslint выполняется запуском команды `npm run lint`

#### Ограничения

- задание должно работать в Chrome
- Использование material design или bootstrap допускается
- Вы НЕ МОЖЕТЕ использовать какие-либо фреймворки, такие как Angular / React / Vue
- Вы можете использовать препроцессоры
- Вы можете общаться, переписываться в чате, гуглить и использовать stackoverflow
- Вы можете использовать lodash.js
- вы должны делать запрос с помощью fetch api

### Последовательность выполнения

- в выданном вам приватном репозитории создать ветку codejam-image-api
- создать папку codejam-image-api. Все файлы проекта должны находиться в папке "codejam-image-api". Организация кода внутри папки на ваше усмотрение.
- Создайте HTML-файл с основным макетом и CSS-стилями для него. Или просто скопируйте ваш html с codejam-canvas / codejam-palette
- Убедиться, что базовая функциональность для управления холстом работает
  - Инициализация холста
  - рисование карандашом
- Добавьте кнопку загрузки изображения
- Попробуйте сделать прототип - загрузить любое изображение на канвас по кнопке
- Зарегистрируйтесь и получите access_token для доступа к апи
  - https://unsplash.com/documentation#creating-a-developer-account
- Разберитесь в документации к апи
  - как делать авторизованные запросы - https://unsplash.com/documentation#public-actions
  - искать фотографии по ключевым словам - https://unsplash.com/documentation#search-photos
- Сделайте запрос, получите ответ, найдите ссылку (url) на фотографию
- замените ссылку в прототипе на полученную в предыдущем шаге
- Коммитьте (commit) ваш код, в процессе реализации функций, то есть:
  1. лейаут для canvas
  2. прототип с загрузкой изображения
  3. запрос на поиск картинки
  4. добавление веб пака
  5. и тд
- Если у вас есть время, начинайте работать над Extra scope
- Рефакторинг и измененение кода до истечения срока.
- залить код на netlify / github pages / https://surge.sh/ / другой сервис

Ментор может оставлять комментарии во время ревью, и вы, как студент, можете пофиксить замечания и получить более высокую оценку.

## Требования к коммитам, PR и репозиторию

[Общие требования из stage 2](https://github.com/rolling-scopes-school/docs/blob/master/docs/stage2.md).

## Оценка

Максимальный балл - **100**

### Основное задание

- [ ] **+30** - кнопка загрузки изображения и отображение изображения на холсте
- [ ] **+10** - есть возможность ввести город для поиска изображений
- [ ] **+5** - поверх загруженного изображения можно рисовать карандашом.
- [ ] **+5** - сохранения состояния канваса после перезагрузки
- [ ] **+10** использовать webpack
- [ ] **+10** использовать async / await

Итого: **70**

### Задание повышенной сложности

- [ ] **+10** - изменение размеров канваса, при изменении размера канваса предыдущее изображение сохраняется и занимает весь размер канваса
- [ ] **+10** - кнопка перевода изображения в черно-белый вид

Итого: **20**

### Задание супер повышенной сложности

- [ ] **+10** - реализована авторизация в приложении через github
  - любым способом - можно использовать сторонние библиотеки

Итого: **10**

### Штрафы

- [ ] **-10** - `eslint` не настроен
- [ ] **-10** загруженное изображение искажается, не сохраняются пропорции
- [ ] **-20** Требования к коммитам, репозиторию и PR не выполнены

## Дополнительная информация

- Ожидаемое время выполнения - 4 - 10 часов без задания повышенной сложности
- fetch api - https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch
- загрузка изображения на canvas - https://developer.mozilla.org/ru/docs/Web/API/CanvasRenderingContext2D/drawImage
- canvas grayscale - https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Pixel_manipulation_with_canvas
- allowing cross-origin use of images and canvas - https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image
- репозиторий с вебпак - https://github.com/abyss-soft/webpack
- настройка вебпак - https://webpack.js.org/guides/getting-started/
- authenticated on netlify with GitHub https://docs.netlify.com/visitor-access/oauth-provider-tokens/#setup-and-settings
- вход на сайт с помощью GitHub.
  - OAuth - https://heap.tech/lore/id26
  - через firebase - https://firebase.google.com/docs/auth/web/github-auth
  - через сторонний виджет - ttps://github.com/netlify/netlify-identity-widget

* Темы: fetch api, async / await

## FAQ

https://docs.google.com/spreadsheets/d/1ynSLhQtwQrv5Nf48MoAd7XdeRNeqVh5H-306vEmyktI/edit
