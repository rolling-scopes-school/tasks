# EnglishPuzzle

| Deadline         | Branch name    | Folder name    |
| ---------------- | -------------- | -------------- |
| 14.06.2020 23:59 | english-puzzle | english-puzzle |

**English-puzzle** - мини-игра, цель которой собрать предложения из размещённых в случайном порядке английских слов.

Прототип приложения - тренировка Конструктор фраз сайта Lingualeo
https://lingualeo.com/ru/training/phrasePuzzle  
Чтобы протестировать работу прототипа, зарегистрируйтесь на сайте Lingualeo и добавьте в Словарь предложения из [разговорников](https://lingualeo.com/ru/dictionary/sets-recommended-phrasebooks).

## Отличия от прототипа

- наличие стартового экрана
- интерфейс приложения выполнен на английском языке
- возможность выбора подсказок:
  - перевод предложения
  - произношение предложения
  - фоновый рисунок на карточках со словами
- карточки со словами являются фрагментами картины и выглядят как элементы пазла
- в блоке с результатами отображаются все десять предложений, собранных в текущем раунде
- когда все десять предложений собраны, фоновый рисунок карточек со словами образует картину

## Структура приложения

- страница авторизации / регистрации нового пользователя
- глобально доступный тулбар с кнопкой logout
- стартовый экран
- основная страница приложения
  - меню
  - блок с подсказками
  - блок с результатами
  - блок с исходными данными
  - кнопки "I don't know", "Check", "Continue", "Results"
- страница статистики

## Макет приложения:

![screenshot](../images/english-puzzle.png)

## Исходные данные

Коллекция из 3600 часто употребляемых английских слов, отсортированных в порядке возрастания сложности. Вся коллекция разбита на шесть частей по 600 слов в каждой. В коллекции есть примеры предложений - **textExample**, которые используются в этой игре.

## Описание функциональных блоков

- форма авторизации / регистрации нового пользователя
- стартовый экран содержит название приложения, краткую инструкцию для пользователя, кнопку Start. Доступен только после успешной авторизации.
- в меню можно выбрать уровень сложности и раунд игры, включить и отключить автопроизношение, выбрать используемые в игре подсказки
- в блоке с подсказками могут находиться перевод предложения и иконка аудио
- в блоке с результатами собираются предложения и находятся уже собранные предложения. Для каждого предложения отводится одна строчка. Ширина всех предложений одинакова. Предложения, в которых больше 10 слов, из игры можно исключить.
- в блоке с исходными данными в случайном порядке размещаются карточки со словами, из которых можно собрать предложение. Ширина карточек со словами пропорциональна длине слова.
- на странице статистики отображаются все предложения раунда. Возле каждого предложения - иконка аудио. При клике по предложению звучит его произношение. Также на странице статистики отображается миниатюра картины, которая была собрана в текущем раунде, и данные о ней: название, автор, дата создания. При клике по миниатюре картина открывается в новой вкладке в полном размере
- страница авторизации, стартовый экран, основная страница приложения и страница статистики занимают весь экран полностью. Если на одной странице отображается содержание второй, это ошибка.

## Работа приложения

- для работы приложения необходимо сделать страницу логина, которая может как авторизировать существующего пользователя, так и регистрировать нового
- если пользователь успешно вошел в систему, приложение загружается со стартового экрана
- вход в систему выполняется только один раз. При перезагрузки страницы пользователь вместо формы авторизации будет попадать на стартовый экран приложения
- в процессе работы приложения, при нажатии на кнопку "Logout", приложение останавливает свою работу, пользователь считается неавторизированным и он перенаправляется на страницу авторизации
- при клике по кнопке "Start", находясь на стартовом экране, открывается основная страница приложения

![screenshot](../images/english-puzzle1.png)

- в игре 6 уровней сложности по количеству частей коллекции исходных данных, в каждом уровне 60 раундов по 10 предложений в каждом. Игра начинается с раунда 1.1 или с того, на котором закончил предыдущую игру пользователь
- в меню по умолчанию включено автопроизношение и подсказки перевод предложения и произношение предложения. Пользовательские настройки меню хранятся в local storage
- выбор подсказки указывает на то, когда появится соответствующая функциональность - до того, как будет собрано предложение, или после. Например, если выбраны все три подсказки, до того как собрано предложение пользователь может прослушать произношение предложения, увидеть его перевод, на карточках со словами отображается фоновый рисунок. Если все три подсказки отключены, до того как собрано предложение подсказок нет. После того как собрано предложение звучит произношение предложения, отображаются перевод предложения и фоновый рисунок на карточках со словами
- у карточек со словами, из которых можно собрать предложение, справа и слева, там, где они соприкасаются между собой, есть фигурные вырезы, как у пазлов. Фон каждой карточки является фрагментом картины. Если включена соответствующая подсказка, фоновый рисунок на карточках со словами отображается, когда они находятся в блоке с исходными данными. Если подсказка отключена, фоновый рисунок отображается только когда предложение собрано правильно
- при клике по словам в блоке с исходными данными, они помещаются в блок с результатами в том порядке, в котором по ним кликали
- слова из блока с исходными данными в блок с результатами можно перетягивать мышкой. При этом слово может помещаться в начало или в конец предложения, или между уже добавленными словами. Также слова можно перетягивать и в пределах предложения, которое собирается в блоке с результатами.
- когда все слова из блока с исходными данными перемещены в блок с результатами, кнопка "I don't know" скрывается, отображается кнопка "Check"
- при клике по кнопке "Check"
  - если предложение собрано верно, все карточки со словами подсвечиваются зелёным цветом, отображаются неиспользованные подсказки, кнопка "Check" скрывается, отображается кнопка "Continue"
  - если предложение собрано неверно, те слова, которые находятся на своих позициях, подсвечиваются зелёным, слова, которые находятся не на своих позициях, подсвечиваются красным, рядом с кнопкой "Check" появляется кнопка "I don't know"

![screenshot](../images/english-puzzle2.png)

- при клике по кнопке "I don't know" слова размещаются в правильном порядке, образуя предложение, отображаются неиспользованные подсказки, кнопки "Check" и "I don't know" скрываются, отображается кнопка "Continue". Клик по кнопке "I don't know" работает аналогично клику по кнопке "Не знаю" в прототипе
- при клике по кнопке "Continue"
  - если собраны не все предложения раунда, происходит переход к следующему предложению: в поле с исходными данными появляются новые слова, из которых можно составить следующее предложение, в поле для вывода результатов подсвечивается следующая строка, в которой можно собрать предложение
  - если собраны все десять предложений, границы между карточками и слова на них исчезают, фоновый рисунок карточек становится непрозрачным, пользователь может увидеть картину, а также краткие сведения о ней: автор, название, год создания. Рядом с кнопкой "Continue" появляется кнопка "Results". Если правильно собраны все десять предложений, при клике по кнопке "Continue" происходит переход к следующему раунду игры.

![screenshot](../images/english-puzzle3.png)

- при клике по кнопке "Results" отображается страница статистики. В разделе статистики "I know" находятся предложения, которые пользователь сумел собрать правильно, вне зависимости от количества попыток и используемых подсказок, в разделе "I don't know" - предложения, которые пользователь открыл кликом по одноимённой кнопке
- на странице статистики есть кнопки "Continue", при клике по ней происходит переход к следующему раунду игры, и "Statistic", при клике по которой открываются результаты ранее сыгранных игр

![screenshot](../images/english-puzzle4.png)

## Требования к репозиторию

- для разработки приложения используйте приватный репозиторий школы. [Как работать с приватным репозиторием](https://docs.rs.school/#/stage2?id=Как-работать-с-приватным-репозиторием)
- история коммитов должна отображать процесс разработки приложения. [Требования к коммитам](https://docs.rs.school/#/git-convention)
- демо-версия приложения размещается на gh-pages [Как сделать деплой задания из приватного репозитория школы](https://docs.rs.school/#/stage2?id=Как-сделать-деплой-задания-из-приватного-репозитория-школы), либо на `https://www.netlify.com/`. При деплое на netlify название страницы с демо-версией даёте по схеме: имя гитхаб аккаунта-название таска.
- после окончания разработки или при наступлении дедлайна, создайте pull request из ветки english-puzzle в ветку master. [Требования к pull request](https://docs.rs.school/#/pull-request-review-process?id=%d0%9e%d0%bf%d0%b8%d1%81%d0%b0%d0%bd%d0%b8%d0%b5-pull-request-%d0%b4%d0%be%d0%bb%d0%b6%d0%bd%d0%be-%d1%81%d0%be%d0%b4%d0%b5%d1%80%d0%b6%d0%b0%d1%82%d1%8c-%d1%81%d0%bb%d0%b5%d0%b4%d1%83%d1%8e%d1%89%d1%83%d1%8e-%d0%b8%d0%bd%d1%84%d0%be%d1%80%d0%bc%d0%b0%d1%86%d0%b8%d1%8e). Мержить pull request не нужно.
- приложение проверятся ментором и другими студентами (кросс-чек)
- для проверки приложения в ходе кросс-чека ссылку на демо-версию приложения необходимо будет добавить в rs-app

## Технические требования

- работа приложения проверяется в браузере Google Chrome последней версии
- использование jQuery не допускается
- использование Angular / React / Vue только по личной договорённости с ментором
- необходимо использовать webpack, eslint, eslint-config-airbnb-base, babel
- можно использовать bootstrap, css фреймворки, html и css препроцессоры

## Критерии оценки:

**Максимальный балл за задание: 180 баллов при кросс-чеке / 180 баллов при проверке ментором**

### Basic scope +40

- [ ] вёрстка, дизайн, UI. Интерактивность кликабельных элементов, различные стили для активного и неактивного состояния. Есть стартовый экран +10
- [ ] карточки со словами выводятся в случайном порядке. При клике по карточкам со словами в блоке с исходными данными, они перемещаются в блок с результатами в том порядке, в котором по ним кликали +10
- [ ] при клике по кнопке "Check", те карточки со словами, которые находятся на своих позициях, подсвечиваются зелёным, карточки, которые находятся не на своих позициях, подсвечиваются красным +10
- [ ] при клике по кнопке "I don't know" слова размещаются в правильном порядке, образуя предложение, отображаются неиспользованные подсказки. Если предложение собрано верно, кнопка "Check" меняется на кнопку "Continue". При клике по кнопке "Continue" происходит переход к следующему предложению +10

### Advanced scope +70

- [ ] можно выбрать уровень сложности и раунд игры. Номера пройденных раундов визуально отличаются. Последний пройденный раунд сохраняется в бекэнде, после запуска игра начинается со следующего за ним раунда +10
- [ ] можно выбрать подсказку перевод предложения +10
- [ ] можно выбрать подсказку произношение предложения. Можно включить и отключить автопроизношение. При проигрывании звука изменяется стиль иконки аудио в блоке с подсказками +10
- [ ] можно выбрать подсказку фоновый рисунок на карточках со словами +10
- [ ] слова между блоком с результатами и блоком с исходными данными можно перетягивать мышкой. Также слова можно перетягивать в пределах предложения, которое собирается в блоке с результатами. +10
- [ ] при перетягивании слово может помещаться в начало или в конец группы слов, или между уже добавленными словами. Если при перетягивании слово отпустили вне целевого блока, оно возвращается на свою прежнюю позицию +10
- [ ] на странице статистики отображаются все предложения раунда. Возле каждого предложения находится иконка аудио. При клике по предложению звучит его произношение. На странице статистики есть разделы "I know" и "I don't know" и кнопка "Continue", а также миниатюра картины, собранной в текущем раунде +10

### Hacker scope +70

- [ ] реализована авторизация и регистрация нового пользователя. Основная часть приложения, включая стартовый экран, доступна только после успешной авторизации. При перезагрузке приложения данные о пользователе сохраняются +10
- [ ] реализован logout, который прекращает работу приложения, делает пользователя анонимным и перенаправляет его на страницу авторизации без доступа к основному приложению +10
- [ ] минимальная ширина страницы, при которой она отображается корректно – 320 рх. На разрешениях меньше десктопного сохраняется максимально возможная часть функционала, внешний вид и работа приложения может изменяться для удобства пользователя +10
- [ ] карточки со словами выглядят как элементы пазла. По бокам, справа и слева, там, где карточки соприкасаются между собой, у них есть фигурные вырезы, как у пазлов +10
- [ ] каждому раунду игры соответствует своя уникальная картина - знаменитое произведение живописи\*. Когда собраны все десять предложений раунда, границы между карточками и слова на них исчезают, пользователь может увидеть картину, а также краткие сведения о ней: автор, название, год создания +10
- [ ] ведётся долгосрочная статистика мини-игры, можно посмотреть когда (дата и время) и с каким результатом в неё играли. После перезагрузки приложения статистика сохраняется. Для хранения статистики используется бекэнд +10
- [ ] если бекэнд не работает или возвращает ошибку, приложение не ломается. Возникающие ошибки в ходе работы с API выводятся в соответствующее уведомление +10

\*Для составления коллекции шедевров живописи рекомендуется объединить усилия студентов курса. Это необходимо не только для экономии времени, но и как подготовка к выполнению командного проекта.

### Штрафные баллы

- [ ] не выполняются требования к pull request, репозиторию, названиям коммитов -10 (оценивает только ментор)
- [ ] не используются webpack, editorconfig, eslint, eslint-config-airbnb-base, babel (в т.ч в составе Angular / React / Vue) -10 (оценивает только ментор)
- [ ] не исправлены ошибки eslint -10 (оценивает только ментор)
- [ ] присутствуют ошибки в консоли, связанные с исполняемым кодом (ошибки типа favicon.ico: Failed to load resource: the server responded with a status of 404 или ошибки, связанные с запросами к API, не учитываются) -10 баллов (оценивает только ментор)

## Cross-check

- инструкция по проведению cross-check: https://docs.rs.school/#/cross-check-flow
- форма для проверки задания: https://cross-check-english-puzzle.netlify.app/

В связи с тем, что бекэнд един для всех работ, то будут ситуации при кроссчеке, когда проверяющий используя свой логин и пароль на проверяемой работе будет получать странные данные в статистике/настройках, либо ошибки в работе приложения. Это будет происходить из-за того, что будут подтягиваться данные из других приложений и они могут не совпадать, либо, что еще более непредсказуемо, совпадать по ключам. В связи с этим при кроссчеке **надо обязательно создавать нового пользователя для каждой из проверяемых работ**, либо как альтернатива можете удалять своего пользователя из базы и создавать его заново. Для удаления пользователя есть соотвествующий REST эндпоинт.

## Информационные ресурсы

- Картинная галерея https://gallerix.ru/a1/

## Материалы

- Yandex.Translate API https://tech.yandex.com/translate/
- Визуализация исходных данных https://rslang-data.netlify.com/
- Drag'n'Drop с событиями мыши https://learn.javascript.ru/mouse-drag-and-drop

## Примеры получения исходных данных

Для этого создан REST API по адресу: https://afternoon-falls-25894.herokuapp.com/

Для тестирования API можно пользоваться Swagger докой по адресу: https://afternoon-falls-25894.herokuapp.com/doc/#/

Описание эндпоинтов(не полное, смотри Swagger Doc):

### Words

GET для получения списка слов:
`https://afternoon-falls-25894.herokuapp.com/words?page=2&group=0` - получить слова со 2-й страницы группы 0  
Строка запроса должна содержать в себе номер группы и номер страницы. Всего 6 групп(от 0 до 5) и в каждой группе по 30 страниц(от 0 до 29). В каждой странице по 20 слов. Группы разбиты по сложности от самой простой(0) до самой сложной(5).

##### Примеры

`https://afternoon-falls-25894.herokuapp.com/words/count?group=1&wordsPerExampleSentenceLTE=10&wordsPerPage=10` - получить количество страниц в группе **1** (по 10 слов на страницу) в которых предложение с примером содержит 10 и менее слов.  
`https://afternoon-falls-25894.herokuapp.com/words?group=0&page=10&wordsPerExampleSentenceLTE=10&wordsPerPage=10` - получить слова из группы **1**, страница **11** (по 10 слов на страницу), в которых предложение с примером содержит 10 и менее слов.

### Users

Система поддерживает разграничение данных по пользователям, в рамках данной задачи вам понадобится создать форму для регистрации пользователя. Для этого надо использовать POST эндпоинт по адресу `/users`. В запросе надо передать JSON объект, который содержит e-mail и password пользователя. Пароль должен содержать не менее 8 символов, как минимум одну прописную букву, одну заглавную букву, одну цифру и один спецсимвол из `+-_@$!%*?&#.,;:[]{}`. Пример запроса:

```javascript
const createUser = async user => {
     const rawResponse = await fetch('https://afternoon-falls-25894.herokuapp.com/users', {
       method: 'POST',
       headers: {
         'Accept': 'application/json',
         'Content-Type': 'application/json'
       },
       body: JSON.stringify(user)
     });
     const content = await rawResponse.json();

     console.log(content);
   };

createUser({ "email": "hello@user.com", "password": "Gfhjkm_123" });
-------------------------------------------------------------------
Console: {
  id: "5ec993df4ca9d600178740ae",
  email: "hello@user.com"
}
```

### Sign In

Чтобы пользоваться эндпоинтами требующими авторизации необходимо залогиниться в систему и получить JWT токен. Для этого существует POST эндоинт по адресу `/signin`. Токены имеют ограниченный срок жизни, в текущей реализации это 4 часа с момента получения. Пример запроса:

```javascript
const loginUser = async user => {
  const rawResponse = await fetch('https://afternoon-falls-25894.herokuapp.com/signin', {
    method: 'POST',
    headers: {
      'Accept': 'application/json',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(user)
  });
  const content = await rawResponse.json();

  console.log(content);
};

loginUser({ "email": "hello@user.com", "password": "Gfhjkm_123" });
-------------------------------------------------------------------
Console:
{
  "message":"Authenticated",
  "token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjVlYzk5M2RmNGNhOWQ2MDAxNzg3NDBhZSIsImlhdCI6MTU5MDI2OTE1OCwiZXhwIjoxNTkwMjgzNTU4fQ.XHKmdY_jk1R7PUbgCZfqH8TxH6XQ0USwPBSKNHMdF6I",
  "userId":"5ec993df4ca9d600178740ae"
}
```

### Users/Words

Полученный при успешном логине токен надо использовать при каждом запросе к эндпоинтам требующим авторизации (в Swagger такие эндпоинты имеют иконку навесного замка. При работе со Swagger полученный токен надо вставить в соответствующее поле формы, которая появляется при нажатии на кнопку `Authorize` вверху страницы справа). Примеры запросов:

```javascript
const token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjVlYzk5M2RmNGNhOWQ2MDAxNzg3NDBhZSIsImlhdCI6MTU5MDI2OTE1OCwiZXhwIjoxNTkwMjgzNTU4fQ.XHKmdY_jk1R7PUbgCZfqH8TxH6XQ0USwPBSKNHMdF6I';
const createUserWord = async ({ userId, wordId, word }) => {
  const rawResponse = await fetch(`https://afternoon-falls-25894.herokuapp.com/users/${userId}/words/${wordId}`, {
    method: 'POST',
    withCredentials: true,
    headers: {
      'Authorization': `Bearer ${token}`,
      'Accept': 'application/json',
      'Content-Type': 'application/json'
    },
    body: JSON.stringify(word)
  });
  const content = await rawResponse.json();

  console.log(content);
};

createUserWord({
  userId: "5ec993df4ca9d600178740ae",
  wordId: "5e9f5ee35eb9e72bc21af716",
  word: { "difficulty": "weak", "optional": {testFieldString: 'test', testFieldBoolean: true} }
});
-------------------------------------------------------------------
Console: {
  "id":"5ec9a92acbbd77001736b167",
  "difficulty":"weak",
  "optional":{
    "testFieldString":"test",
    "testFieldBoolean":true
  },
  "wordId":"5e9f5ee35eb9e72bc21af716"
}

const getUserWord = async ({ userId, wordId }) => {
  const rawResponse = await fetch(`https://afternoon-falls-25894.herokuapp.com/users/${userId}/words/${wordId}`, {
    method: 'GET',
    withCredentials: true,
    headers: {
      'Authorization': `Bearer ${token}`,
      'Accept': 'application/json',
    }
  });
  const content = await rawResponse.json();

  console.log(content);
};

getUserWord({
  userId: "5ec993df4ca9d600178740ae",
  wordId: "5e9f5ee35eb9e72bc21af716"
});
-------------------------------------------------------------------
Console: {
  "id":"5ec9a92acbbd77001736b167",
  "difficulty":"weak",
  "optional":{
    "testFieldString":"test",
    "testFieldBoolean":true
  },
  "wordId":"5e9f5ee35eb9e72bc21af716"
}
```

Также существуют эндпоинты для сохранения статистики и настроек пользователя. `\users\{id}\statistics` и `\users\{id}\settings` соответственно. Работа с ними основывается на тех же принципах, что описаны и показаны в примерах выше.  
Объект `optional` у UserWord, Statistics, Settings имеет ограничение по размеру - не более 30 полей и общая длина объекта после `JSON.stringify()` не должна превышать 1500 символов. Структуру этих объектов вы разрабатываете сами исходя из требований и вашей реализации задачи.

REST сервис возвращает только JSON, без изображений и звуковых файлов. Для доступа к ним сделайте fork репозитория https://github.com/irinainina/rslang-data. В папке files находятся изображения и аудиофайлы.

Например, для изображения files/01_0009.jpg ссылка будет следующей:
`https://raw.githubusercontent.com/irinainina/rslang-data/master/files/01_0009.jpg`  
Для аудио files/01_0009_example.mp3 ссылка будет следующей: `https://raw.githubusercontent.com/irinainina/rslang-data/master/files/01_0009_example.mp3`  
Обратите внимание, что вместо irinainina надо указать свой github username.

Ещё один вариант получения исходных данных - файлы, которые находятся в папке data форкнутого репозитория.

Также, если вам чего-то не хватает в текущей реализации, то вы можете форкнуть backend репозиторий, изменить его под свою реализацию, задеплоить и использовать.  
[Git repository link](https://github.com/rolling-scopes/LearnWords)

### Документ для вопросов

- документ для вопросов, связанных с выполнением задания: https://docs.google.com/spreadsheets/d/1pEz7Y1G1dwgILxj8-ZS_kLP3X_2Azpnuz84OBoD1lD4/edit#gid=0
- ссылки на лучшие работы добавьте, пожалуйста, в эту форму: https://forms.gle/F5W9xv8odL9AeuFg9
