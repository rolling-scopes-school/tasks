# Пример 2: Codenames — Interview Edition

Пример многопользовательской игры Codenames, адаптированной под подготовку к интервью (слова на поле — JS/TS/Front-end концепты). В этом примере показаны возможности интеграции LLM: например, AI в роли капитана (Spymaster) для игры в одиночку или проверка ответов в фазе Check. Интеграция LLM не обязательна: можно сначала реализовать игру целиком, а затем добавить интеграцию с LLM или другие фичи.

---

## Концепция

Классическая игра Codenames (https://en.wikipedia.org/wiki/Codenames_(board_game)), где:

- Поле 5x5 со словами: `closure`, `hoisting`, `prototype`, `async/await`...
- Капитан даёт подсказку ("Асинхронность, 3") — команда угадывает слова
- **Solo Mode:** AI Agent играет роль капитана, генерируя подсказки
- Real-time синхронизация через WebSocket
- **Фаза Check (проверка знаний):** Очки за слово начисляются только после проверки знаний: игрок отвечает на блиц-вопрос по выбранному концепту. Карточка после клика открывается для всех (слово «угадано»), но очко команде засчитывается лишь при успешной проверке; при неуспехе карточка остаётся открытой, но без очка.

---

## Ключевые фичи

- Создание/присоединение к комнате по коду
- Роли: Капитан (Spymaster) и Оперативники (Operatives)
- AI Spymaster для игры в одиночку
- Таймер хода, история ходов
- Фаза Check (проверка знаний): пауза после клика по карточке, блиц-вопрос по концепту; очко только при успешной проверке
- Режимы проверки: само/взаимооценка («Знаю» / «Не знаю») или проверка ответа через AI (текст или Speech-to-Text)
- Анимации при угадывании слов
- Адаптивный дизайн (можно играть с телефона)

---

## Правила игры

### Подготовка

1. Создается комната, игроки делятся на две команды (Red / Blue)
2. В каждой команде выбирается Капитан (Spymaster)
3. Генерируется поле 5x5 со словами (JS/TS концепты)
4. Капитаны видят "карту" — какие слова принадлежат какой команде

### Ход игры

1. Капитан даёт **подсказку**: одно слово + число
   - Пример: "Асинхронность, 3" — означает 3 слова связаны с асинхронностью
2. Команда обсуждает и выбирает слова по очереди
3. При правильном угадывании (клик по своей карточке) слово "открывается"; затем обязательно фаза Check — итог (очко или нет) определяется результатом проверки
4. **Проверка знаний:** игра ставится на паузу, открывается попап с вопросом по выбранному слову (например: «В чём отличие от sessionStorage?», «Лимит объёма данных?»). В зависимости от настроек комнаты:
   - **Режим само/взаимооценки:** игрок отвечает (устно/письменно), нажимает «Показать ответ», затем сам или соперники оценивают: «Знаю» / «Не знаю» → очко засчитывается только при «Знаю»
   - **Режим AI:** игрок вводит ответ текстом или голосом (Speech-to-Text); AI оценивает суть ответа и решает, засчитать очко или нет
     После завершения проверки попап закрывается, игра продолжается (карточка уже открыта; очко либо засчитано, либо нет)
5. При ошибке (клик по чужой карточке или бомбе) — ход переходит к другой команде

### Победа

- Команда, открывшая все свои слова первой, побеждает
- Если команда выбирает "бомбу" — мгновенный проигрыш

### Фаза Check (Проверка знаний)

- **Когда срабатывает:** сразу после клика по карточке своей команды. Карточка открывается (все видят слово), очко засчитывается только после успешной проверки.
- **Поведение:** таймер хода на паузе, остальной UI затемнён/заблокирован, по центру модальное окно.
- **Содержимое попапа:** формулировка вопроса (из банка вопросов к слову), поле ввода или кнопка «Показать ответ», затем кнопки «Знаю» / «Не знаю» (режим само/взаимооценки) или кнопка отправки и вывод решения AI (режим AI).
- **Режимы:**
  - **Self/Peer:** вопрос → ответ игрока → «Показать ответ» → оценка «Знаю/Не знаю» (игрок или соперники) → очко при «Знаю»
  - **AI:** вопрос → ответ (текст или Speech-to-Text) → отправка в AI → решение AI (засчитать/не засчитать) → очко по решению AI
- Набор вопросов к словам хранится на бэкенде или в конфиге (Words DB или отдельный Question bank).

## Страницы приложения

| Страница   | URL                | Описание                                                                                       |
| ---------- | ------------------ | ---------------------------------------------------------------------------------------------- |
| Landing    | `/`                | Главная с описанием игры                                                                       |
| Login      | `/login`           | Вход                                                                                           |
| Register   | `/register`        | Регистрация                                                                                    |
| Lobby      | `/lobby`           | Список комнат + создание                                                                       |
| Room       | `/room/:code`      | Ожидание игроков, выбор ролей, **режим проверки:** «Само/взаимооценка» или «Проверка через AI» |
| Game       | `/game/:code`      | Игровое поле                                                                                   |
| Solo Setup | `/solo`            | Настройка игры с AI, выбор **режима проверки** (по умолчанию — AI)                             |
| Solo Game  | `/solo/play`       | Игра с AI Spymaster                                                                            |
| Results    | `/results/:gameId` | Результаты игры                                                                                |

---

## Пример UI: Игровое поле

```
┌─────────────────────────────────────────────────────────────┐
│  CODENAMES: Interview Edition          Room: js-masters-42  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────┬─────────┬─────────┬─────────┬─────────┐       │
│  │ closure │prototype│ Promise │  this   │ hoisting│       │
│  │  (RED)  │ (BLUE)  │  (RED)  │(NEUTRAL)│  (RED)  │       │
│  ├─────────┼─────────┼─────────┼─────────┼─────────┤       │
│  │  event  │  scope  │  async  │  class  │  arrow  │       │
│  │  loop   │  chain  │  await  │         │  func   │       │
│  │ (BLUE)  │  (RED)  │ (BLUE)  │ (BOMB)  │(NEUTRAL)│       │
│  ├─────────┼─────────┼─────────┼─────────┼─────────┤       │
│  │ spread  │  rest   │ destruct│ template│ Symbol  │       │
│  │         │         │         │         │         │       │
│  │(NEUTRAL)│ (BLUE)  │ (RED)   │ (BLUE)  │ (RED)   │       │
│  ├─────────┼─────────┼─────────┼─────────┼─────────┤       │
│  │ WeakMap │ Proxy   │ Reflect │ iterator│generator│       │
│  │         │         │         │         │         │       │
│  │ (BLUE)  │(NEUTRAL)│ (RED)   │ (BLUE)  │ (RED)   │       │
│  ├─────────┼─────────┼─────────┼─────────┼─────────┤       │
│  │ BigInt  │ private │ static  │ super   │ extends │       │
│  │         │         │         │         │         │       │
│  │(NEUTRAL)│ (RED)   │ (BLUE)  │(NEUTRAL)│ (BLUE)  │       │
│  └─────────┴─────────┴─────────┴─────────┴─────────┘       │
│                                                             │
│  Red: 4 left    Blue: 3 left    Timer: 1:45                │
│                                                             │
│  ─────────────────────────────────────────────────────────  │
│                                                             │
│  Spymaster says: "Асинхронность, 3"                        │
│  (Hint for: Promise, event loop, async/await)              │
│                                                             │
│  Click a word to guess!                                     │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Пример UI: попап Check (проверка знаний)

Игра на паузе, таймер остановлен. В AI-режиме вместо «Знаю/Не знаю» — кнопка отправки и затем вывод решения AI.

```
┌─────────────────────────────────────────────────────────────┐
│  Проверка знаний                                    [×]     │
├─────────────────────────────────────────────────────────────┤
│  Слово: localStorage                                        │
│                                                             │
│  Вопрос: В чём отличие от sessionStorage?                   │
│                                                             │
│  [Поле ввода ответа или область для голоса]                 │
│                                                             │
│  [Показать ответ]   [Знаю]  [Не знаю]                        │
│  (или в AI-режиме: [Отправить на проверку])                 │
└─────────────────────────────────────────────────────────────┘
```

---

## Пример UI: Lobby

```
┌─────────────────────────────────────────────────────────────┐
│  CODENAMES: Interview Edition                    [Profile]  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  [Play Solo with AI]                                │   │
│  │  Practice with AI Spymaster                         │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ─────────────────── OR ───────────────────                │
│                                                             │
│  [Create Room]     Room Code: [______] [Join]              │
│                                                             │
│  ─────────────────────────────────────────────────────────  │
│                                                             │
│  Public Rooms:                                              │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ js-masters-42    │ 3/4 players │ Waiting │ [Join]  │   │
│  │ ts-ninjas-07     │ 2/4 players │ Waiting │ [Join]  │   │
│  │ algo-pros-99     │ 4/4 players │ Playing │ [Watch] │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  Your Stats:                                                │
│  Games: 15  │  Wins: 9  │  Win Rate: 60%                   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## AI Spymaster (Solo Mode)

### Как это работает

1. AI получает "карту" — знает, какие слова принадлежат игроку
2. AI генерирует подсказку, связывающую несколько слов
3. Игрок угадывает слова
4. После угадывания срабатывает та же **фаза Check** (вопрос по слову); в Solo по умолчанию используется режим **AI-проверки** (настраивается в Solo Setup)
5. AI адаптирует сложность подсказок

### Пример промпта для AI

```
You are a Codenames Spymaster for the RED team.
Your words: ["closure", "Promise", "async", "hoisting"]
Opponent words: ["prototype", "scope", "rest"]
Neutral: ["class", "arrow", "spread"]
Bomb: ["eval"]

Give a one-word clue and a number. The clue must relate to some of your words.
Format: CLUE, NUMBER

Example: "Асинхронность, 3" (relates to Promise, async, and hoisting order)
```

### Пример промпта для AI-проверки ответа (Check)

```
Concept: localStorage. Question: "В чём отличие от sessionStorage?"
Player's answer: "[текст или расшифровка голоса]"

Evaluate whether the answer correctly captures the main difference (e.g. lifetime: localStorage persists, sessionStorage clears when tab closes). Reply with: POINT_GRANTED or POINT_DENIED, and optionally one short sentence of feedback.
```

## Примеры дополнительных фич

- **Банк вопросов:** редактор вопросов к концептам (для ментора/админа)
- **Spectator Mode:** Наблюдение за играми других
- **Tournaments:** Турнирная сетка
- **Custom Word Packs:** Загрузка своих слов
- **Voice Chat:** Интеграция с WebRTC
- **Achievements:** Достижения за игру
