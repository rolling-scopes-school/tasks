# Пример 1: Widget Trainer

Пример приложения — интерактивный тренажер с визуальными заданиями. По желанию студенты могут реализовать модуль интеграции с LLM.

## Концепция

Классическое SPA для подготовки к интервью:
- Пользователь выбирает тему (Core JS, TypeScript, Algorithms)
- Решает интерактивные задания (виджеты)
- Видит прогресс и историю сессий

## Ключевые фичи

- Dashboard с прогрессом и историей сессий
- Библиотека тем с фильтрацией и поиском
- Интерактивные виджеты: Quiz, Memory Game, Async Sorter, Stack Builder
- Система XP и Streaks
- Responsive design

## User Flow

```
Landing Page → Регистрация/Вход → Dashboard → Выбор темы → Практика → Фидбек → Dashboard
```

```mermaid
flowchart TD
    A[Landing Page] --> B{Авторизован?}
    B -->|Нет| C[Login / Register]
    C --> D[Dashboard]
    B -->|Да| D

    D --> E[Library - Список тем]
    E --> F[Фильтрация и Поиск]
    F --> G[Выбор темы]

    G --> H[Практика - Виджет]
    H --> I[Интерактивное задание]
    I --> J[Валидация ответа]
    J -->|Неверно| I
    J -->|Верно| K[Результат]

    K --> L[Report Card]
    L --> M[Сохранение прогресса]
    M --> D
```

---

## Страницы приложения

| Страница | URL | Описание | Компонент |
|----------|-----|----------|-----------|
| Landing | `/` | Главная для гостей | Landing Page |
| Login | `/login` | Вход | Auth |
| Register | `/register` | Регистрация | Auth |
| Dashboard | `/dashboard` | Главная + История сессий | Dashboard |
| Library | `/library` | Список тем | Library |
| Practice | `/practice/:topicId` | Практика (виджет) | Widget Engine |
| Profile | `/profile` | Профиль пользователя | Profile |
| 404 | `/*` | Страница не найдена | Not Found |

---

## Примеры UI

### Dashboard

```
┌─────────────────────────────────────────────────────────┐
│  Tandem                              [Profile] [Logout] │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  Привет, Иван!                                          │
│                                                         │
│  ┌─────────────────────┐  ┌─────────────────────┐      │
│  │  Прогресс           │  │  Streak: 5 дней     │      │
│  │  ████████░░ 80%     │  │                     │      │
│  └─────────────────────┘  └─────────────────────┘      │
│                                                         │
│  История сессий:                                        │
│  ┌─────────────────────────────────────────────────┐   │
│  │ Core JS       │ 85/100  │ 2 дня назад │ [→]    │   │
│  │ Algorithms    │ 72/100  │ 3 дня назад │ [→]    │   │
│  │ TypeScript    │ 90/100  │ 5 дней назад│ [→]    │   │
│  └─────────────────────────────────────────────────┘   │
│  [1] [2] [3]  (Pagination)                             │
│                                                         │
│  [Начать практику]                                      │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### Library (Выбор темы)

```
┌─────────────────────────────────────────────────────────┐
│  Tandem > Library                    [Profile] [Logout] │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  Выберите тему для практики                             │
│                                                         │
│  [Поиск...]  [Фильтр: Все]  [Сложность: Все]           │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │ Core JS                                         │   │
│  │ Замыкания, прототипы, this, event loop          │   │
│  │ Сложность: 3    │  Прогресс: 80%  │ [Начать]   │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  ┌─────────────────────────────────────────────────┐   │
│  │ TypeScript                                      │   │
│  │ Типы, generics, utility types                   │   │
│  │ Сложность: 3    │  Прогресс: 60%  │ [Начать]   │   │
│  └─────────────────────────────────────────────────┘   │
│                                                         │
│  [1] [2] [3] ... [10]  (Pagination)                    │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### Practice (Widget - Async Sorter)

```
┌─────────────────────────────────────────────────────────┐
│  Tandem > Core JS > Async Sorter      [Skip] [Submit]   │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  В каком порядке выведутся console.log?                 │
│  Перетащи блоки в правильные очереди:                   │
│                                                         │
│  Код:                                                   │
│  ┌───────────────────────────────────────────────┐     │
│  │ console.log('1');                              │     │
│  │ setTimeout(() => console.log('2'), 0);         │     │
│  │ Promise.resolve().then(() => console.log('3'));│     │
│  │ console.log('4');                              │     │
│  └───────────────────────────────────────────────┘     │
│                                                         │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐          │
│  │ Call Stack │ │ Microtasks │ │ Macrotasks │          │
│  │            │ │            │ │            │          │
│  │ [1] [4]    │ │ [3]        │ │ [2]        │          │
│  └────────────┘ └────────────┘ └────────────┘          │
│                                                         │
│  Итоговый порядок: [ 1 ] [ 4 ] [ 3 ] [ 2 ]             │
│                                                         │
│                                        [Run Loop]       │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## Widget Engine

**Описание:** Движок для загрузки виджетов по JSON-схеме.

**Функциональность:**
- Получение схемы от backend
- Динамическая загрузка виджетов
- Общий интерфейс для всех виджетов
- Валидация ответов

> Детальная архитектура Widget Engine описана в [widget-engine.md](./01-widget-trainer/widget-engine.md)

---

## Виджеты

### Легкие виджеты

| Виджет | Описание | Сложность |
|--------|----------|-----------|
| Quiz | Классический тест с выбором одного ответа | Easy |
| True/False | Утверждение — правда или ложь? | Easy |
| Code Completion | Заполни пропуски в коде | Medium |
| Code Ordering | Расставь строки кода в правильном порядке (D&D) | Medium |

> Детали реализации легких виджетов в [widget-engine.md](./01-widget-trainer/widget-engine.md)

### Сложные виджеты

| Виджет | Описание | Сложность |
|--------|----------|-----------|
| Async Sorter | "Event Loop Game" — распредели код по очередям | Hard |
| Memory Game | "Be the Garbage Collector" — найди мусор в памяти | Hard |
| Stack Builder | "Call Stack Game" — управляй стеком вызовов | Hard |

> Детали реализации:
> - [async-sorter.md](./01-widget-trainer/async-sorter.md) — Event Loop Game с D&D, Touch API, A11y
> - [memory-game.md](./01-widget-trainer/memory-game.md) — GC Game с визуальным графом объектов

---

## Примеры JSON-схем виджетов

### Quiz Widget

```json
{
  "type": "quiz",
  "question": "Что вернет typeof null?",
  "options": ["null", "undefined", "object", "NaN"]
}
```

### True/False Widget

```json
{
  "type": "true-false",
  "statement": "Promise.all() возвращает результаты в порядке завершения промисов",
  "explanation": "Promise.all() сохраняет порядок входного массива"
}
```

### Code Completion Widget

```json
{
  "type": "code-completion",
  "code": "const result = arr.___(x => x > 0);",
  "blanks": ["___"]
}
```

### Code Ordering Widget

```json
{
  "type": "code-ordering",
  "description": "Реализуй debounce функцию",
  "lines": [
    "return function(...args) {",
    "let timeout;",
    "clearTimeout(timeout);",
    "timeout = setTimeout(() => fn(...args), delay);",
    "};"
  ]
}
```

---

## Memory Game: «Be the Garbage Collector»

### Концепция

Вместо того чтобы писать сложный алгоритм, который сам находит мусор, мы просим студента стать Garbage Collector'ом.

### Сценарий

1. **Слева:** Визуальный граф объектов (кружочки) и ссылок (стрелочки). Все запутано.
2. **Справа:** Короткий код, который только что выполнился. Например: `user = null;` или `list.next = null;`.
3. **Задача:** "Кликни на все объекты, которые должны быть удалены из памяти после выполнения этого кода".

### UI Механика

* **Корневой объект (Root):** Всегда подсвечен (например, `window`).
* **Состояние:** Изначально все объекты "живые".
* **Действие:** Пользователь кликает на объекты, помечая их как "Dead" (красный цвет).
* **Валидация (Кнопка "Collect"):**
  * Если помечен объект, до которого *можно* добраться от Root → **Ошибка** ("Удалили живой объект!").
  * Если не помечен объект, до которого *нельзя* добраться → **Ошибка** ("Memory Leak! Вы пропустили мусор").

### Что проверяет:

* Понимание **Reachability** (достижимости).
* Понимание **Reference Counting** vs **Mark-and-Sweep**.
* Понимание циклических ссылок (когда два объекта ссылаются друг на друга, но недостижимы из корня).

> Детали реализации в [memory-game.md](./01-widget-trainer/memory-game.md)

---

## Stack Builder: "Call Stack Game"

### Концепция

Студент должен вручную "исполнить" роль интерпретатора, управляя стеком вызовов.

### Сценарий

1. **Слева:** Код с вложенными вызовами функций или рекурсией. Активная строка кода подсвечивается.
2. **По центру:** Пустой "стакан" (Stack).
3. **Снизу:** Блоки с именами функций (`main`, `funcA`, `funcB`, `console.log`).
4. **Задача:** "Воспроизведи состояние стека на момент, когда код остановился на строке 5".

### UI Механика (Drag & Drop)

* Пользователь перетаскивает блоки в стакан.
* Блоки ложатся друг на друга (LIFO).
* Можно выкидывать блоки из стакана (симуляция `return`).
* **Усложнение:** Пошаговый режим. Пользователь жмет "Next Line" и должен либо добавить функцию в стек, либо убрать её.

### Что проверяет:

* Понимание принципа **LIFO** (Last In, First Out).
* Понимание **Рекурсии** (почему стек растет).
* Понимание порядка выполнения синхронного кода.

---

## Async Sorter: "Event Loop Game"

### Концепция

Самый популярный вопрос на собеседованиях: "В каком порядке выведутся console.log?". Этот виджет геймифицирует этот вопрос.

### Сценарий

1. **Сверху:** Код с миксом из `console.log`, `setTimeout`, `Promise.resolve().then()`.
2. **Снизу:** Четыре зоны (Buckets):
   * **Call Stack** (Синхронно / Сейчас)
   * **Microtasks** (Promise, queueMicrotask)
   * **Macrotasks** (setTimeout, setInterval)
   * **Console / Output** (Итоговый вывод)

3. **Задача:** Распределить строчки кода (блоки) по правильным зонам или выстроить итоговую очередь выполнения.

### UI Механика (Sorting / D&D)

* Пользователь видит блоки с кодом (например, `setTimeout(..., 0)`).
* Перетаскивает их в правильную очередь.
* Нажимает "Run Loop".
* Виджет анимирует, как Event Loop забирает задачи: Сначала Stack → Потом ВСЕ Microtasks → Потом ОДНА Macrotask.

### Что проверяет:

* Разницу между **Microtasks** и **Macrotasks**.
* Понимание того, что `setTimeout(0)` не срабатывает мгновенно.
* Порядок выполнения промисов.

> Детали реализации в [async-sorter.md](./01-widget-trainer/async-sorter.md)

---

## Детальная документация

Для планирования, реализации и оценки рисков смотрите документы в папке [01-widget-trainer/](./01-widget-trainer/):

| Документ | Описание |
|----------|----------|
| [README.md](./01-widget-trainer/README.md) | Навигация по документам |
| [scoring-and-plan.md](./01-widget-trainer/scoring-and-plan.md) | Расчет баллов, 6-недельный план, Cut Scope Strategy |
| [data-contracts.md](./01-widget-trainer/data-contracts.md) | TypeScript типы, API методы, Mock vs Real Mode |
| [widget-engine.md](./01-widget-trainer/widget-engine.md) | Архитектура движка, простые виджеты |
| [async-sorter.md](./01-widget-trainer/async-sorter.md) | Event Loop Game: D&D, Touch API, A11y |
| [memory-game.md](./01-widget-trainer/memory-game.md) | GC Game: граф объектов, алгоритм валидации |
| [risks-and-mitigations.md](./01-widget-trainer/risks-and-mitigations.md) | Риски, типичные ошибки, Bus Factor |
